{% load mathfilters %}

<div>
    <h2 class="title">List of chains</h2>
    <div class="module whiteBG">
        <table class="tablesorter chain-report center">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Start</th>
                    <th>Hits</th>
                    <th>Respect</th>
                    <th>Report</th>
            </thead>
            <tbody>
            {% for chain in chains %}
            <tr>
                {% if chain.start == 1 %}
                    <td>-</td>
                    <td>current chain</td>
                {% else %}
                    <td>{{chain.tId}}</td>
                    <td>{{chain.startDate}}</td>
                {% endif %}
                <td><b>{{chain.nHits}}</b></td>
                <td><b>{{chain.respect|floatformat:2}}</b></td>
                <td>
                    {% if chain.have_report %}
                        {% if request.session.chainer.AA %}
                            <a href={% url 'chain:report' chain.tId %}>      <i class="fas fa-eye" title="see report"></i></a> -
                            <a href={% url 'chain:createReport' chain.tId %}><i class="fas fa-sync-alt" title="refresh report"></i></a> -
                            <a href={% url 'chain:deleteReport' chain.tId %}><i class="fas fa-trash-alt" title="delete report"></i></a> -
                            <a href={% url 'chain:toggleReport' chain.tId %}>   {% if chain.jointReport %}
                                                                                    <i class="fas fa-toggle-on" title="remove from joint report"></i>
                                                                                {% else %}
                                                                                    <i class="fas fa-toggle-off" title="add to report"></i>
                                                                                {% endif %}</a>
                        {% else %}
                            <a href={% url 'chain:report' chain.tId %}><i class="fas fa-eye" title="see report"></i></a>
                        {% endif %}
                    {% else %}
                        {% if request.session.chainer.AA %}
                            <a href={% url 'chain:createReport' chain.tId %}><i class="fas fa-plus-square" title="create report"></i></a>
                        {% else %}
                            <i class="fas fa-times-circle" title="no report, ask AA to to create it"></i>
                        {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
        <div class="submit-row">
        {% if request.session.chainer.AA %}
            <a href={% url 'chain:createList' %}><input type="submit" class="update-type" value="Refresh chain list"></a>
                {% else %}
            <a><input type="submit" class="update-type" value="You need AA right to refresh the list"></a>
        {% endif %}
        </div>
    </div>
</div>
